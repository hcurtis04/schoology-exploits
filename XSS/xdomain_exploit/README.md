XDomain is a 3rd party library used by Schoology to bypass restrictions from CORS. XDomain works by creating an iframe element on the DOM known as a "proxy", and then forwards all requests through the proxy using `iframe.postMessage`.

An attack idea would be to control the proxy, that way we can return malicious data instead of what the webpage was actually requesting for. 

In Schoology's PDF viewer, it allows us to control the path of the proxy, but not the origin. Here's an example of this:
If we enter `/PATH/proxy.html` as the path, the following proxy URL will be generated
`https://app.schoology.com/PATH/proxy.html` 
As you can see, it takes the path we entered and appends it directly on top of the origin, which is https://app.schoology.com.

In order to control the proxy, we need to be able to control the origin, but by the looks of it we can only control the path. However if you look closely there is actually a small flaw in this design that allows me to control the origin.

The flaw is that the path is appended directly on top of the origin, and does not actually check if the path is a valid path, which means we can simply extend the origin from the path. Here is an example:
If we enter `.malicious.com/PATH/proxy.html` as the path, the following proxy URL will be generated:
`https://app.schoology.com.malicious.com/PATH/proxy.html`
Now `app.schoology.com` is a subdomain of `malicious.com`, which is a domain that I can control. By doing this, we have basically hijacked the proxy and can do whatever we want from here.

The next step is writing a new proxy page that returns malicious data instead of the actual data. In this case, the best types of requests to hijack are ones that are requesting for javascript, that way we can control javascript and turn this into an XSS exploit.

See source code for `proxy.html` to see the code I used to do this.
